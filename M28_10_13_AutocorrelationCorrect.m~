t(1)=0;                      %Initial time
dt=pi/50;
potential(1)=rand;           %Initial random potential
S(1)=rand;
n=50;                         %Number of steps
i=1;

    for k=2:1:n
        potential(k)=potential(k-1)+(sqrt(dt))*(randn);   %Calculates potential 
        S(k)=S(1)*exp((a-0.5*(b^2))*t(k)+b*potential(k));
        t(k)=t(k-1)+dt;                                 %Time increment
    end
    
 M=0;
 N=0;
    
     for k=1:1:n-i
        M=M+S(k)
    end
 
    Meana=M/(n-i)
    
    for k=1:1:n-i
        a(k)=(S(k)-Meana)
    end
   
    
    for k=1+i:1:n
        N=N+S(k)
    end
    
    Meanb=N/(n-i)
    
    for k=1:1:n-i
        b(k)=(S(k+i)-Meanb)
    end
    
 A=sum(a.^2)
 B=sum(b.^2)
 
 den=sqrt(A*B)

num=sum(a.*b)
 
 autocorrelation=num/den
 


 



